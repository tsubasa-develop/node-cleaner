(()=>{var t={562:t=>{function e(t){return"number"==typeof t||!!/^0x[0-9a-f]+$/i.test(t)||/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(t)}function o(t,e){return"constructor"===e&&"function"==typeof t[e]||"__proto__"===e}t.exports=function(t,n){n||(n={});var i={bools:{},strings:{},unknownFn:null};"function"==typeof n.unknown&&(i.unknownFn=n.unknown),"boolean"==typeof n.boolean&&n.boolean?i.allBools=!0:[].concat(n.boolean).filter(Boolean).forEach((function(t){i.bools[t]=!0}));var r={};Object.keys(n.alias||{}).forEach((function(t){r[t]=[].concat(n.alias[t]),r[t].forEach((function(e){r[e]=[t].concat(r[t].filter((function(t){return e!==t})))}))})),[].concat(n.string).filter(Boolean).forEach((function(t){i.strings[t]=!0,r[t]&&(i.strings[r[t]]=!0)}));var s=n.default||{},c={_:[]};Object.keys(i.bools).forEach((function(t){u(t,void 0!==s[t]&&s[t])}));var l=[];function u(t,o,n){if(!n||!i.unknownFn||function(t,e){return i.allBools&&/^--[^=]+$/.test(e)||i.strings[t]||i.bools[t]||r[t]}(t,n)||!1!==i.unknownFn(n)){var s=!i.strings[t]&&e(o)?Number(o):o;a(c,t.split("."),s),(r[t]||[]).forEach((function(t){a(c,t.split("."),s)}))}}function a(t,e,n){for(var r=t,s=0;s<e.length-1;s++){if(o(r,c=e[s]))return;void 0===r[c]&&(r[c]={}),r[c]!==Object.prototype&&r[c]!==Number.prototype&&r[c]!==String.prototype||(r[c]={}),r[c]===Array.prototype&&(r[c]=[]),r=r[c]}var c;o(r,c=e[e.length-1])||(r!==Object.prototype&&r!==Number.prototype&&r!==String.prototype||(r={}),r===Array.prototype&&(r=[]),void 0===r[c]||i.bools[c]||"boolean"==typeof r[c]?r[c]=n:Array.isArray(r[c])?r[c].push(n):r[c]=[r[c],n])}function f(t){return r[t].some((function(t){return i.bools[t]}))}-1!==t.indexOf("--")&&(l=t.slice(t.indexOf("--")+1),t=t.slice(0,t.indexOf("--")));for(var h=0;h<t.length;h++){var d=t[h];if(/^--.+=/.test(d)){var g=d.match(/^--([^=]+)=([\s\S]*)$/),p=g[1],v=g[2];i.bools[p]&&(v="false"!==v),u(p,v,d)}else if(/^--no-.+/.test(d))u(p=d.match(/^--no-(.+)/)[1],!1,d);else if(/^--.+/.test(d))p=d.match(/^--(.+)/)[1],void 0===(_=t[h+1])||/^-/.test(_)||i.bools[p]||i.allBools||r[p]&&f(p)?/^(true|false)$/.test(_)?(u(p,"true"===_,d),h++):u(p,!i.strings[p]||"",d):(u(p,_,d),h++);else if(/^-[^-]+/.test(d)){for(var y=d.slice(1,-1).split(""),m=!1,b=0;b<y.length;b++){var _;if("-"!==(_=d.slice(b+2))){if(/[A-Za-z]/.test(y[b])&&/=/.test(_)){u(y[b],_.split("=")[1],d),m=!0;break}if(/[A-Za-z]/.test(y[b])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(_)){u(y[b],_,d),m=!0;break}if(y[b+1]&&y[b+1].match(/\W/)){u(y[b],d.slice(b+2),d),m=!0;break}u(y[b],!i.strings[y[b]]||"",d)}else u(y[b],_,d)}p=d.slice(-1)[0],m||"-"===p||(!t[h+1]||/^(-|--)[^-]/.test(t[h+1])||i.bools[p]||r[p]&&f(p)?t[h+1]&&/^(true|false)$/.test(t[h+1])?(u(p,"true"===t[h+1],d),h++):u(p,!i.strings[p]||"",d):(u(p,t[h+1],d),h++))}else if(i.unknownFn&&!1===i.unknownFn(d)||c._.push(i.strings._||!e(d)?d:Number(d)),n.stopEarly){c._.push.apply(c._,t.slice(h+1));break}}return Object.keys(s).forEach((function(t){var e,o,n;e=c,o=t.split("."),n=e,o.slice(0,-1).forEach((function(t){n=n[t]||{}})),o[o.length-1]in n||(a(c,t.split("."),s[t]),(r[t]||[]).forEach((function(e){a(c,e.split("."),s[t])})))})),n["--"]?(c["--"]=new Array,l.forEach((function(t){c["--"].push(t)}))):l.forEach((function(t){c._.push(t)})),c}},451:function(t,e,o){"use strict";var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function c(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,c)}l((n=n.apply(t,e||[])).next())}))},i=this&&this.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,o=t[Symbol.asyncIterator];return o?o.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(o){e[o]=t[o]&&function(e){return new Promise((function(n,i){!function(t,e,o,n){Promise.resolve(n).then((function(e){t({value:e,done:o})}),e)}(n,i,(e=t[o](e)).done,e.value)}))}}};Object.defineProperty(e,"__esModule",{value:!0}),e.NodeCleaner=void 0;const r=o(988);e.NodeCleaner=class{constructor(t){this.targets=[],this.effectiveTargets=[],this.completeTargets=[],this.config=Object.assign({root:".",limit:5,forceMode:!1,suMode:!1,checkMode:!1},t)}run(){return n(this,void 0,void 0,(function*(){console.log(`${this.config.root} 内を検索します。`),this.search(),console.log(""),console.log("○ 検索結果"),console.log(`● ${this.length}件のnode_modulesを検出しました。`),console.log(`● 合計サイズは${this.totalSize}です。`),this.config.checkMode||(yield this.scanning(),this.showResult())}))}search(){return this.targets=r.exec.getTargetDirsWithSize(this.config.root,"node_modules",this.config.suMode),this.effectiveTargets=this.targets,this.config.limit>-1&&(this.effectiveTargets=this.effectiveTargets.slice(0,this.config.limit)),this.targets}scanning(){var t,e,o,s;return n(this,void 0,void 0,(function*(){this.config.limit>-1&&this.config.limit<this.length&&console.log(`● サイズ容量上位${this.config.limit}件のみを対象とします。`),console.log("");try{for(var n,c=!0,l=i(Object.entries(this.effectiveTargets));n=yield l.next(),!(t=n.done);){s=n.value,c=!1;try{const[t,e]=s;this.config.forceMode?this.delete(e):(console.log(`(${Number(t)+1}/${this.effectiveLength}) ${e.path} (${e.formatSize})を削除しますか？`),(yield r.Interactive.confirm("> "))?this.delete(e):console.log("スキップしました。"),console.log(""))}finally{c=!0}}}catch(t){e={error:t}}finally{try{c||t||!(o=l.return)||(yield o.call(l))}finally{if(e)throw e.error}}this.config.forceMode&&console.log("")}))}delete(t){r.exec.delete(t.path,this.config.suMode),this.completeTargets.push(t),console.log(`削除しました。${t.path}`)}showResult(){console.log("○ 削除結果"),console.log(`● 削除対象：${this.length}件（${this.totalSize}）`),console.log(`● 削除済み：${this.completeLength}件（${this.completeTotalSize}）`)}get length(){return this.targets.length}get totalSize(){return(0,r.block2unitByte)(this.targets.reduce(((t,e)=>t+Number(e.size)),0))}get effectiveLength(){return this.effectiveTargets.length}get effectiveTotalSize(){return(0,r.block2unitByte)(this.effectiveTargets.reduce(((t,e)=>t+Number(e.size)),0))}get completeLength(){return this.completeTargets.length}get completeTotalSize(){return(0,r.block2unitByte)(this.completeTargets.reduce(((t,e)=>t+Number(e.size)),0))}}},988:function(t,e,o){"use strict";var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function c(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,c)}l((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.exec=e.Interactive=e.block2unitByte=void 0;const r=i(o(521)),s=o(81);e.block2unitByte=t=>{let e=512*t,o=0;for(;e>=1e3;)e/=1e3,o++;return`${e.toFixed(1)}${["B","KB","MB","GB","TB","PB","EB","ZB","YB"][o]}`},e.Interactive={confirm:t=>n(void 0,void 0,void 0,(function*(){const o=yield e.Interactive.question(`${t}(y/n): `),n=o.trim().toLowerCase();return["y","n"].includes(n)?"y"===o.trim().toLowerCase():(console.log("y/nで答えてください。"),yield e.Interactive.confirm(t))})),question:t=>{const e=r.default.createInterface({input:process.stdin,output:process.stdout});return new Promise((o=>{e.question(t,(t=>{o(t),e.close()}))}))}},e.exec={getTargetDirsWithSize:(t,o,n=!1)=>{const i=n?"sudo":"";return(0,s.execSync)(`${i} find ${t} -name "${o}" -type d -prune | ${i} xargs du -s | ${i} sort -h -r`).toString().split("\n").filter((t=>t)).map((t=>t.trim())).map((t=>{const[o,n]=t.split("\t");return{size:Number(o),formatSize:(0,e.block2unitByte)(Number(o)),path:n}}))},delete:(t,e=!1)=>{const o=e?"sudo":"";(0,s.execSync)(`${o} rm -rf ${t}`)}}},607:function(t,e,o){"use strict";var n,i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function c(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,c)}l((n=n.apply(t,e||[])).next())}))},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=o(451),c=(0,r(o(562)).default)(process.argv.slice(2)),l={root:(null===(n=c._)||void 0===n?void 0:n[0])||".",limit:Number.isInteger(c.l)?c.l:5,forceMode:!!c.force,suMode:!!c.su,checkMode:!!c.check};i(void 0,void 0,void 0,(function*(){new s.NodeCleaner(l).run()}))},81:t=>{"use strict";t.exports=require("child_process")},521:t=>{"use strict";t.exports=require("readline")}},e={};!function o(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,o),r.exports}(607)})();